<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp"><head><link rel="SHORTCUT ICON" href="./../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { }.OH_footer { }</style><link rel="stylesheet" type="text/css" href="./../styles/branding.css" /><link rel="stylesheet" type="text/css" href="./../styles/branding-en-US.css" /><style type="text/css">
			body
			{
			border-left:5px solid #e6e6e6;
			overflow-x:scroll;
			overflow-y:scroll;
			}
		</style><script src="./../scripts/branding.js" type="text/javascript"><!----></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>GDI32.NativeMethods.CreateCompatibleBitmap Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="CreateCompatibleBitmap method" /><meta name="System.Keywords" content="GDI32.NativeMethods.CreateCompatibleBitmap method" /><meta name="Microsoft.Help.F1" content="SharpBlade.Native.WinAPI.GDI32.NativeMethods.CreateCompatibleBitmap" /><meta name="Microsoft.Help.Id" content="M:SharpBlade.Native.WinAPI.GDI32.NativeMethods.CreateCompatibleBitmap(System.IntPtr,System.Int32,System.Int32)" /><meta name="Description" content="The CreateCompatibleBitmap function creates a bitmap compatible with the device that is associated with the specified device context." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="'true'" /><meta name="container" content="SharpBlade.Native.WinAPI" /><meta name="file" content="831eca68-6e89-2cae-f862-acb9e41cb0b3" /><meta name="guid" content="831eca68-6e89-2cae-f862-acb9e41cb0b3" /><link type="text/css" rel="stylesheet" href="./../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"><!----></script><meta name="SelfBranded" content="true" /></head><body onload="onLoad()" class="primary-mtps-offline-document"><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn">GDI32<span id="ID0EDBABAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EDBABAAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>NativeMethods<span id="ID0EBBABAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBBABAAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>CreateCompatibleBitmap Method </td><td class="OH_tdRunningTitleColumn">SharpBlade documentation</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle"></span><div class="summary">
            The CreateCompatibleBitmap function creates a bitmap compatible with
            the device that is associated with the specified device context.
            </div><p></p><strong>Namespace:</strong> <a href="f804a396-6751-5ad5-690b-ee6df664647e.htm" target="">SharpBlade.Native.WinAPI</a><br /><strong>Assembly:</strong> <span sdata="assembly">SharpBlade</span> (in SharpBlade.dll) Version: 5.0.0 Stable<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Syntax</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><div id="snippetGroup_Syntax" class="code"><div id="ID0EDGDAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EDGDAAAAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0EDGDAAAAA_tabimgleft"></div><div id="ID0EDGDAAAAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EDGDAAAAA','C#','1','4');return false;">C#</a></div><div id="ID0EDGDAAAAA_tab2" class="OH_CodeSnippetContainerTab" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EDGDAAAAA','Visual Basic','2','4');return false;">VB</a></div><div id="ID0EDGDAAAAA_tab3" class="OH_CodeSnippetContainerTab" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EDGDAAAAA','Visual C++','3','4');return false;">C++</a></div><div id="ID0EDGDAAAAA_tab4" class="OH_CodeSnippetContainerTab" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0EDGDAAAAA','F#','4','4');return false;">F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EDGDAAAAA_tabimgright"></div></div><div id="ID0EDGDAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EDGDAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EDGDAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EDGDAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EDGDAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EDGDAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EDGDAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EDGDAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre>[<span class="identifier">DllImportAttribute</span>("gdi32.dll")]
<span class="keyword">internal</span> <span class="keyword">static</span> <span class="identifier">IntPtr</span> <span class="identifier">CreateCompatibleBitmap</span>(
	<span class="identifier">IntPtr</span> <span class="parameter">hdc</span>,
	<span class="identifier">int</span> <span class="parameter">nWidth</span>,
	<span class="identifier">int</span> <span class="parameter">nHeight</span>
)</pre></div><div id="ID0EDGDAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>[DllImportAttribute("gdi32.dll")]
internal static IntPtr CreateCompatibleBitmap(
	IntPtr hdc,
	int nWidth,
	int nHeight
)</pre></div><div id="ID0EDGDAAAAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre>&lt;<span class="identifier">DllImportAttribute</span>("gdi32.dll"&gt;]
<span class="keyword">Friend</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CreateCompatibleBitmap</span> ( 
	<span class="parameter">hdc</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">nWidth</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">nHeight</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
) <span class="keyword">As</span> <span class="identifier">IntPtr</span></pre></div><div id="ID0EDGDAAAAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre>&lt;DllImportAttribute("gdi32.dll"&gt;]
Friend Shared Function CreateCompatibleBitmap ( 
	hdc As IntPtr,
	nWidth As Integer,
	nHeight As Integer
) As IntPtr</pre></div><div id="ID0EDGDAAAAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre><span class="keyword">internal</span>:
[<span class="identifier">DllImportAttribute</span>(L"gdi32.dll")]
<span class="keyword">static</span> <span class="identifier">IntPtr</span> <span class="identifier">CreateCompatibleBitmap</span>(
	<span class="identifier">IntPtr</span> <span class="parameter">hdc</span>, 
	<span class="identifier">int</span> <span class="parameter">nWidth</span>, 
	<span class="identifier">int</span> <span class="parameter">nHeight</span>
)</pre></div><div id="ID0EDGDAAAAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre>internal:
[DllImportAttribute(L"gdi32.dll")]
static IntPtr CreateCompatibleBitmap(
	IntPtr hdc, 
	int nWidth, 
	int nHeight
)</pre></div><div id="ID0EDGDAAAAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre>[&lt;<span class="identifier">DllImportAttribute</span>("gdi32.dll")&gt;]
<span class="keyword">internal</span> <span class="keyword">static</span> <span class="keyword">member</span> <span class="identifier">CreateCompatibleBitmap</span> : 
        <span class="parameter">hdc</span> : <span class="identifier">IntPtr</span> * 
        <span class="parameter">nWidth</span> : <span class="identifier">int</span> * 
        <span class="parameter">nHeight</span> : <span class="identifier">int</span> <span class="keyword">-&gt;</span> <span class="identifier">IntPtr</span></pre></div><div id="ID0EDGDAAAAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre>[&lt;DllImportAttribute("gdi32.dll")&gt;]
internal static member CreateCompatibleBitmap : 
        hdc : IntPtr * 
        nWidth : int * 
        nHeight : int -&gt; IntPtr</pre></div></div></div><script>addSpecificTextLanguageTagSet('ID0EDGDAAAAA');</script></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="hdc"><dt><span class="parameter">hdc</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="ID0EBCACFDAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBCACFDAAAAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>IntPtr</a><br /><span>A handle to a device context.</span></dd></dl><dl paramName="nWidth"><dt><span class="parameter">nWidth</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="ID0EBCABFDAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBCABFDAAAAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>Int32</a><br /><span>The bitmap width, in pixels.</span></dd></dl><dl paramName="nHeight"><dt><span class="parameter">nHeight</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="ID0EBCAAFDAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBCAAFDAAAAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>Int32</a><br /><span>The bitmap height, in pixels.</span></dd></dl></div><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a><br />
            If the function succeeds, the return value is a handle to the compatible bitmap (DDB).
            If the function fails, the return value is NULL.
            <div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Remarks</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div>
            The color format of the bitmap created by the <span class="code">CreateCompatibleBitmap</span> function matches
            the color format of the device identified by the <span class="code">hdc</span> parameter.
            This bitmap can be selected into any memory device context that
            is compatible with the original device.
            Because memory device contexts allow both color and monochrome bitmaps,
            the format of the bitmap returned by the <span class="code">CreateCompatibleBitmap</span> function
            differs when the specified device context is a memory device context.
            However, a compatible bitmap that was created for a nonmemory device context
            always possesses the same color format and uses the same color palette
            as the specified device context.
            Note: When a memory device context is created, it initially has a
            1-by-1 monochrome bitmap selected into it.
            If this memory device context is used in <span class="code">CreateCompatibleBitmap</span>,
            the bitmap that is created is a monochrome bitmap.
            To create a color bitmap, use the <span class="code">HDC</span> that was used to create the memory device context,
            as shown in the following code:
            <div id="ID0EPCAAAAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EPCAAAAA_tabs"></div><div id="ID0EPCAAAAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EPCAAAAA_ViewColorized" href="#" onclick="javascript:ExchangeTitleContent('ID0EPCAAAAA','4')" title="View Colorized" style="display: none">View Colorized</a><a id="ID0EPCAAAAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EPCAAAAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EPCAAAAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EPCAAAAA','4')" title="Print">Print</a></div></div><div id="ID0EPCAAAAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre>HDC memDC = CreateCompatibleDC ( hDC );
HBITMAP memBM = CreateCompatibleBitmap ( hDC, nWidth, nHeight );
SelectObject ( memDC, memBM );</pre></div><div id="ID0EPCAAAAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>HDC memDC = CreateCompatibleDC ( hDC );
HBITMAP memBM = CreateCompatibleBitmap ( hDC, nWidth, nHeight );
SelectObject ( memDC, memBM );</pre></div></div></div><script>addSpecificTextLanguageTagSet('ID0EPCAAAAA');</script>
            If an application sets the <span class="code">nWidth</span> or <span class="code">nHeight</span> parameters to zero,
            <span class="code">CreateCompatibleBitmap</span> returns the handle to a 1-by-1 pixel, monochrome bitmap.
            If a DIB section, which is a bitmap created by the <span class="code">CreateDIBSection</span> function,
            is selected into the device context identified by the <span class="code">hdc</span> parameter,
            <span class="code">CreateCompatibleBitmap</span> creates a DIB section.
            When you no longer need the bitmap, call the <span class="code">DeleteObject</span> function to delete it.
            <a name="seeAlsoSection"><!----></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><div class="seeAlsoStyle"><a href="2e2bf8cc-dd8a-3cbd-9585-22689b03cad7.htm" target="">GDI32<span id="ID0EBABAAAAAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBABAAAAAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>NativeMethods Class</a></div><div class="seeAlsoStyle"><a href="f804a396-6751-5ad5-690b-ee6df664647e.htm" target="">SharpBlade.Native.WinAPI Namespace</a></div></div></div></div></div><div id="OH_footer" class="OH_footer"><p><a href="https://github.com/SharpBlade/SharpBlade" target="_blank">Project Page</a></p><p><a href="https://github.com/SharpBlade/SharpBlade/blob/master/LICENSE" target="_blank">Copyright (c) 2013-2014 by Adam Hellberg and Brandon Scott. (https://github.com/SharpBlade/SharpBlade/blob/master/LICENSE)</a></p><div class="OH_feedbacklink"><a href="mailto:info@sharpblade.net?subject=SharpBlade+documentation+GDI32.NativeMethods.CreateCompatibleBitmap+Method++100+EN-US&amp;body=Your%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report%2c%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed%2c%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.">Send Feedback</a> on this topic to info@sharpblade.net.</div></div></body></html>